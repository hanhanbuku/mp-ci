"use strict";const t=require("miniprogram-ci"),o=require("./utils");class s{constructor(t){this.options=t,this.project=null}init(){this.project=new t.Project({...this.options.config()});const s=()=>({project:this.project,version:this.options.baseConfig().version||o.getVersion(),desc:this.options.baseConfig().desc,robot:this.options.baseConfig().desc.robot||30,setting:this.options.baseConfig().setting??{es6:!0,es7:!0}});this.upload(s),this.preview(s)}upload(o){t.upload({...o(),onProgressUpdate:({_status:t,_msg:o})=>{}}).then((({subPackageInfo:t})=>{})).catch((t=>{process.exit(1)}))}preview(o){t.preview({...o(),onProgressUpdate:()=>{},qrcodeFormat:"base64",qrcodeOutputDest:"qrcode.text"}).then((({subPackageInfo:t})=>{})).catch((t=>{process.exit(1)}))}}function e(t){return t?t instanceof Function?t():t:null}exports.run=function(t){const{config:o,baseConfig:i}=t;try{new s({config:e(o),baseConfig:e(i)}).init()}catch(t){}};
